!function(e,n){function i(){function i(){Object.keys(n.AF.CountryMappings.list).forEach(t)}function t(e){if(u.countryElement.querySelector('[value="'+e.toUpperCase()+'"]')||u.countryElement.querySelector('[value="'+n.AF.CountryMappings.list[e].title+'"]')){var i=new n.AF.ShopifyWidget,t=u.activeAddressGroup.fields[Object.keys(u.activeAddressGroup.fields)[0]].element();i.init(t,e.toUpperCase()),u.widgets.push(i)}}function o(e,i){Object.keys(u.activeAddressGroup.fields).forEach(function(t){var o=u.activeAddressGroup.fields[t],r=u.activeWidget.country.fieldAPIMappings[o.mappingId];if("NZ"==u.activeWidget.country.iso&&"function"==r.type){var a=new n.AddressFinder.NZSelectedAddress(e,i);o.setValue(a[r.name]())}else if("lookup"==r.type){var s=n.AF.CountryMappings.findProvinceValueByAPI(u.activeWidget.country.iso,i[r.name]);n.console.log("provinceLookups:",s);var d=null;s.forEach(function(e){if(o.element().querySelector('[value="'+e+'"]'))return void(d=e)}),n.console.log("new province alias:",d),n.console.log("fieldItem",o),o.setValue(d)}else o.setValue(i[r.name])})}function r(){u.widgets.forEach(function(e){e.instance.on("result:select",o)})}function a(){Object.keys(u.activeAddressGroup.fields).forEach(function(e){u.activeAddressGroup.fields[e].setValue()})}function s(e){var i=n.AF.CountryMappings.findCountryISOByValue(e);u.activeCountryISO=i,u.activeWidget=null,u.widgets.forEach(function(e){e.setStateByCountry(i)&&(u.activeWidget=e)})}function d(e){var n=e.target.value;n!=u.activeCountryISO&&(u.activeWidget&&a(),s(n))}var u=this;return u.activeAddressGroup=null,u.countryElement=null,u.activeCountryISO=null,u.activeWidget=null,u.widgets=[],u.init=function(t){u.activeAddressGroup=t,u.countryElement=e.querySelector(u.activeAddressGroup.countryField),n.console.log("f.countryElement",u.countryElement),u.activeAddressGroup&&u.activeAddressGroup.fields&&u.countryElement&&(i(),u.countryElement.addEventListener("change",d),s(u.countryElement.value),r())},u}n.AF?n.AF.AddressGroup=i:n.AF={AddressGroup:i}}(document,window),function(e){var n={list:{au:{iso:"AU",title:"Australia",provinceAPIMappings:{ACT:["Australian Capital Territory","ACT"],NSW:["New South Wales","NSW"],NT:["Northern Territory","NT"],QLD:["Queensland","QLD"],SA:["South Australia","SA"],TAS:["Tasmania","TAS"],VIC:["Victoria","VIC"],WA:["Western Australia","WA"]},fieldAPIMappings:{address1:{name:"address_line_1",type:"field"},address2:{name:"address_line_2",type:"field"},city:{name:"locality_name",type:"field"},province:{name:"state_territory",type:"lookup"},zip:{name:"postcode",type:"field"}}},nz:{iso:"NZ",title:"New Zealand",provinceAPIMappings:{"Auckland Region":["Auckland","AUK"],"Bay of Plenty Region":["Bay of Plenty","BOP"],"Canterbury Region":["Canterbury","CAN"],"Gisborne Region":["Gisborne","GIS"],"Hawke's Bay Region":["Hawke's Bay","HKB"],"Manawatu-Wanganui Region":["Manawatu-Wanganui","MWT"],"Marlborough Region":["Marlborough","MBH"],"Nelson Region":["Nelson","NSN"],"Northland Region":["Northland","NTL"],"Otago Region":["Otago","OTA"],"Southland Region":["Southland","STL"],"Taranaki Region":["Taranaki","TKI"],"Tasman Region":["Tasman","TAS"],"Waikato Region":["Waikato","WKO"],"Wellington Region":["Wellington","WGN"],"West Coast Region":["West Coast","WTC"]},fieldAPIMappings:{address1:{name:"address_line_1_and_2",type:"function"},address2:{name:"suburb",type:"function"},city:{name:"city",type:"function"},province:{name:"region",type:"lookup"},zip:{name:"postcode",type:"function"}}}},findProvinceFieldValueAlias:function(e,n){return this.list[e.toLowerCase()].provinceFieldAliases[n]},findProvinceValueByAPI:function(e,n){return this.list[e.toLowerCase()].provinceAPIMappings[n]},findMappingByValue:function(e){var n=this.list,i=n[e.toLowerCase()];return i||Object.keys(n).forEach(function(t){var o=n[t];o.title.toUpperCase()==e.toUpperCase()&&(i=o)}),i},findCountryAttributeByValue:function(e,n){var i=this.findMappingByValue(n);return i?i[e]:n},findCountryISOByValue:function(e){return this.findCountryAttributeByValue("iso",e)}};e.AF?e.AF.CountryMappings=n:e.AF={CountryMappings:n}}(window),function(e){function n(e,n){var i=this;return i.mappingId=n,i.selector=e,i.element=function(){return document.querySelector(i.selector)},i.setValue=function(e){void 0===e&&(e=""),i.element().value=e},i}e.AF?e.AF.FormField=n:e.AF={FormField:n}}(window),function(e){function n(){function n(e,n){var t="";return t+=o.prefix,n.prefix&&(t+=n.prefix),t+="country"===e?"country":i[e],n.suffix&&(t+=n.suffix),t+=o.suffix}function r(){var t={};return i.forEach(function(i,o){var r=n(o,a.activeMapping),s=new e.AF.FormField(r,i);t[r]=s}),t}var a=this;return a.activeMapping=null,a.findAddressGroups=function(){var e=[];return t.forEach(function(i,o){a.activeMapping=t[o];var s=n(0,a.activeMapping);document.querySelector(s)&&(a.activeMapping.countryField="select"+n("country",a.activeMapping),a.activeMapping.fields=r(),e.push(a.activeMapping))}),e},a}var i=["address1","address2","city","province","zip"],t=[{prefix:"checkout[billing_address][",suffix:"]"},{prefix:"checkout[shipping_address][",suffix:"]"},{suffix:"_billing"},{suffix:"_shipping"},{prefix:"address[",suffix:"]"}],o={prefix:'[name="',suffix:'"]'};e.AF?e.AF.FormFieldMappings=n:e.AF={FormFieldMappings:n}}(window),function(e,n){function i(n){var i=e.createElement("script");i.src="https://api.addressfinder.io/assets/v3/widget.js",i.async=1,void 0!==n&&(i.onload=n),e.body.appendChild(i)}function t(e){n.require.config({context:"af",baseUrl:"",paths:{addressfinder:"https://api.addressfinder.io/assets/v3/core",reqwest:"https://files-abletech-nz.s3.amazonaws.com/addressfinder/reqwest",neat_complete:"https://files-abletech-nz.s3.amazonaws.com/addressfinder/neat-complete"}})(n.require(["addressfinder"],function(i){void 0!==e&&e(i),n.console.log("AddressFinder",i)}))}function o(e){n.define&&n.define.amd&&"function"==typeof n.define?t(e):i(e)}function r(){return window.AF&&window.AF.Widget}function a(){return this.loadScript=function(e){r()?e():o(e)},this}n.AF?n.AF.ScriptLoader=a:n.AF={ScriptLoader:a}}(document,window),function(e){function n(){function n(){i.instance=new e.AddressFinder.Widget(i.field,i.AFKey,i.country.iso)}var i=this;return i.AFKey=null,i.field=null,i.country=null,i.instance=null,i.setStateByCountry=function(e){var n=i.country.iso==e;return n?i.instance.enable():i.instance.disable(),n},i.init=function(t,o){i.AFKey=e.AddressFinderPlugin.key,t&&(i.field=t),o&&(i.country=e.AF.CountryMappings.findMappingByValue(o)),e.AddressFinder&&e.AddressFinder.Widget&&n()},i}e.AF?e.AF.ShopifyWidget=n:e.AF={ShopifyWidget:n}}(window),function(e){function n(n){e.console&&e.console.warn&&e.console.warn(n)}function i(){var n=new e.AF.FormFieldMappings,i=n.findAddressGroups();i.forEach(function(n,t){var o=new e.AF.AddressGroup;n.fields&&(o.init(n),i[t]=o)}),e.console.log("addressGroups",i)}function t(){var t=!1;[{objName:"AddressFinderPlugin",message:"No AddressFinder Key specified. See: https://addressfinder.nz/docs/shopify/"},{objName:"AddressFinder",message:"The AddressFinder Widget Script failed to load."},{objName:"AF",message:"One or more of the AF Shopify script packages are not loaded."}].forEach(function(i){if(!e[i.objName])return n(i.message),void(t=!0)}),t||i()}(new e.AF.ScriptLoader).loadScript(t)}(window);